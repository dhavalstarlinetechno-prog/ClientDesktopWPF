<Window x:Class="ClientDesktop.Main.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ClientDesktop.Main"
        xmlns:dock="https://github.com/Dirkster99/AvalonDock"
        xmlns:dockThemes="clr-namespace:AvalonDock.Themes;assembly=AvalonDock.Themes.VS2013"
        xmlns:details="clr-namespace:ClientDesktop.View.Details;assembly=ClientDesktop.View"
        WindowState="Maximized"
        mc:Ignorable="d"
        Title="MetaTrader 5" Height="800" Width="1200"
        UseLayoutRounding="True" SnapsToDevicePixels="True"
        Icon="{x:Null}">

    <!-- Commands Binding for Shortcuts -->
    <Window.CommandBindings>
        <CommandBinding Command="{x:Static local:MainWindow.ToggleMarketWatchCommand}" Executed="ToggleMarketWatch_Executed"/>
        <CommandBinding Command="{x:Static local:MainWindow.ToggleNavigatorCommand}" Executed="ToggleNavigator_Executed"/>
        <CommandBinding Command="{x:Static local:MainWindow.ToggleToolboxCommand}" Executed="ToggleToolbox_Executed"/>
    </Window.CommandBindings>

    <!-- Keyboard Shortcuts -->
    <Window.InputBindings>
        <KeyBinding Key="M" Modifiers="Control" Command="{x:Static local:MainWindow.ToggleMarketWatchCommand}"/>
        <KeyBinding Key="N" Modifiers="Control" Command="{x:Static local:MainWindow.ToggleNavigatorCommand}"/>
        <KeyBinding Key="T" Modifiers="Control" Command="{x:Static local:MainWindow.ToggleToolboxCommand}"/>
    </Window.InputBindings>
    <Grid Background="#F0F0F0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Menu -->
            <RowDefinition Height="*"/>
            <!-- Docking Area -->
            <RowDefinition Height="Auto"/>
            <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- ========================================================= -->
        <!-- 1. TOP MENU BAR (Split into Left and Right)               -->
        <!-- ========================================================= -->
        <Grid Grid.Row="0" Background="#F0F0F0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <!-- Left Side: Main Menu -->
                <ColumnDefinition Width="Auto"/>
                <!-- Right Side: User Menu -->
            </Grid.ColumnDefinitions>

            <!-- A. LEFT SIDE MENUS -->
            <Menu Grid.Column="0" Background="Transparent" Padding="0,2">
                <MenuItem Header="New Order" FontWeight="Bold"/>

                <MenuItem Header="Window">
                    <!-- Market Watch -->
                    <MenuItem Header="Market Watch" InputGestureText="Ctrl+M" 
                              Command="{x:Static local:MainWindow.ToggleMarketWatchCommand}">
                        <MenuItem.Icon>
                            <Grid Width="15" Height="15">
                                <Path Data="M 1 6 L 4.5 1 L 8 6 L 6 6 L 6 11 L 3 11 L 3 6 Z" 
                                  Fill="#00C000" Stroke="#006000" StrokeThickness="1"/>

                                <!-- Red Down Arrow (Right) -->
                                <Path Data="M 10 10 L 10 5 L 12 5 L 12 10 L 14 10 L 11 14 L 8 10 Z" 
                                  Fill="#FF4040" Stroke="#A00000" StrokeThickness="1"/>
                            </Grid>
                        </MenuItem.Icon>
                    </MenuItem>
                    <!-- Navigator -->
                    <MenuItem Header="Navigator" InputGestureText="Ctrl+N"
                              Command="{x:Static local:MainWindow.ToggleNavigatorCommand}">
                        <MenuItem.Icon>
                            <Grid Width="16" Height="16">
                                <Path Data="M 4,5 V 13 M 4,8 H 8 M 4,13 H 8" 
          Stroke="#007ACC" StrokeThickness="1"/>

                                <Path Data="M 2,1 h 4 v 4 h -4 z M 8,6 h 4 v 4 h -4 z M 8,11 h 4 v 4 h -4 z" 
          Fill="#FFD700" Stroke="#B8860B" StrokeThickness="1"/>
                            </Grid>
                        </MenuItem.Icon>
                    </MenuItem>
                    <!-- Toolbox -->
                    <MenuItem Header="Details" InputGestureText="Ctrl+T"
                              Command="{x:Static local:MainWindow.ToggleToolboxCommand}">
                        <MenuItem.Icon>
                            <Grid Width="16" Height="16">
                                <Path Data="M 2,3 H 14 V 8 H 2 Z" Fill="White"/>

                                <Path Data="M 2,8 H 14 V 13 H 2 Z" Fill="#FFD700"/>

                                <Path Data="M 2,3 H 14 V 13 H 2 Z M 2,8 H 14" 
          Stroke="#007ACC" StrokeThickness="1"/>

                                <Path Data="M 4,10.5 H 7 M 9,10.5 H 12" 
          Stroke="Black" StrokeThickness="1" SnapsToDevicePixels="True"/>
                            </Grid>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
            </Menu>

            <!-- B. RIGHT SIDE USER MENU (Connect/Disconnect) -->
            <Menu Grid.Column="1" Background="Transparent" Padding="0,2,10,2">
                <MenuItem x:Name="UserMenu" Padding="5,2">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <!-- User Icon -->
                            <Grid Width="20" Height="20">
                                <Path x:Name="UserIconPath" 
                                      Data="M12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                      Fill="#666666" 
                                      Stretch="Uniform" Width="16" Height="16" VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Username (Visible only after login) -->
                            <TextBlock x:Name="TxtUserName" Text="User" 
                                       Margin="5,0,0,0" VerticalAlignment="Center" 
                                       FontWeight="SemiBold" Visibility="Collapsed"
                                       Foreground="#333333"/>
                        </StackPanel>
                    </MenuItem.Header>

                    <!-- Option 1: Connect (Visible when Logged Out) -->
                    <MenuItem x:Name="MenuConnect" Header="Connect to Account" Click="MenuConnect_Click">
                        <MenuItem.Icon>
                            <Path Data="M10,17L15,12L10,7V10H3V14H10V17M18,19H21V5H18V19Z" Fill="Green" Stretch="Uniform" Width="12" Height="12"/>
                        </MenuItem.Icon>
                    </MenuItem>

                    <!-- Option 2: Disconnect (Visible when Logged In) -->
                    <MenuItem x:Name="MenuDisconnect" Header="Disconnect" Click="MenuDisconnect_Click" Visibility="Collapsed">
                        <MenuItem.Icon>
                            <Path Data="M9,13V19H12V13M9,5V11H12V5M9,1V3H12V1" Fill="Red" Stretch="Uniform" Width="12" Height="12"/>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
            </Menu>
        </Grid>

        <!-- AVALONDOCK MANAGER -->
        <dock:DockingManager Grid.Row="1" x:Name="dockManager" AllowMixedOrientation="True">
            <dock:DockingManager.Theme>
                <dockThemes:Vs2013LightTheme/>
            </dock:DockingManager.Theme>

            <dock:LayoutRoot>
                <dock:LayoutPanel Orientation="Vertical">
                    <dock:LayoutPanel Orientation="Horizontal">

                        <!-- LEFT SIDEBAR GROUP -->
                        <dock:LayoutAnchorablePaneGroup Orientation="Vertical" DockWidth="250">

                            <!-- Market Watch -->
                            <dock:LayoutAnchorablePane DockHeight="*">
                                <dock:LayoutAnchorable x:Name="MarketWatchPane" Title="Market Watch" ContentId="MarketWatch" CanClose="False" CanAutoHide="False">
                                    <Grid Background="White"/>
                                </dock:LayoutAnchorable>
                            </dock:LayoutAnchorablePane>

                            <!-- Navigator -->
                            <dock:LayoutAnchorablePane DockHeight="*">
                                <dock:LayoutAnchorable x:Name="NavigatorPane" Title="Navigator" ContentId="Navigator" CanClose="False" CanAutoHide="False">
                                    <Grid Background="White"/>
                                </dock:LayoutAnchorable>
                            </dock:LayoutAnchorablePane>

                        </dock:LayoutAnchorablePaneGroup>

                        <!-- Center: Charts -->
                        <dock:LayoutDocumentPane>
                            <dock:LayoutDocument Title="Chart" ContentId="Chart" CanClose="True">
                                <Grid Background="Black"/>
                            </dock:LayoutDocument>
                        </dock:LayoutDocumentPane>
                    </dock:LayoutPanel>

                    <!-- BOTTOM SECTION: Details -->
                    <dock:LayoutAnchorablePane DockHeight="200">
                        <dock:LayoutAnchorable x:Name="ToolboxPane" Title="Toolbox" ContentId="Toolbox" CanClose="False" CanAutoHide="False">
                            <details:DetailsMainView />
                        </dock:LayoutAnchorable>
                    </dock:LayoutAnchorablePane>
                </dock:LayoutPanel>
            </dock:LayoutRoot>
        </dock:DockingManager>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Background="#F0F0F0" BorderBrush="#D0D0D0" BorderThickness="0,1,0,0" Height="22">
            <StatusBarItem Content="For Help, press F1" Foreground="#666" FontSize="11"/>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Default" Margin="0,0,20,0" Foreground="Black" FontSize="11"/>
                    <Rectangle Width="1" Height="14" Fill="#CCC" Margin="0,0,10,0"/>
                    <Grid Width="16" Height="12" Margin="0,0,5,0" VerticalAlignment="Center">
                        <Rectangle Width="3" Height="4" Fill="#00C000" VerticalAlignment="Bottom" HorizontalAlignment="Left"/>
                        <Rectangle Width="3" Height="7" Fill="#00C000" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="4,0,0,0"/>
                        <Rectangle Width="3" Height="10" Fill="#00C000" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="8,0,0,0"/>
                        <Rectangle Width="3" Height="12" Fill="#00C000" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="12,0,0,0"/>
                    </Grid>
                    <TextBlock Text="143.63 ms" Foreground="Black" FontSize="11"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>